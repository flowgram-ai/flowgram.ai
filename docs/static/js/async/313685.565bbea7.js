"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["313685"],{294672:function(e,a,r){r.r(a),r.d(a,{default:function(){return o}});var n=r(110239),t=r(444827);function i(e){let a=Object.assign({h1:"h1",a:"a",h2:"h2",pre:"pre",code:"code",h3:"h3",p:"p"},(0,t.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.h1,{id:"use-variables",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#use-variables",children:"#"}),"Use Variables"]}),"\n",(0,n.jsxs)(a.h2,{id:"enable-variable-engine",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#enable-variable-engine",children:"#"}),"Enable Variable Engine"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-tsx",meta:'pure title="use-editor-props.ts"',children:"\n// EditorProps\n{\n  variableEngine: {\n    /**\n     * Need to enable the variable engine to use\n     */\n    enable: true\n  }\n}\n"})}),"\n",(0,n.jsxs)(a.h2,{id:"node-output-variables",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#node-output-variables",children:"#"}),"Node Output Variables"]}),"\n",(0,n.jsxs)(a.h3,{id:"set-output-variables-through-flownodevariabledata",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#set-output-variables-through-flownodevariabledata",children:"#"}),"Set Output Variables through FlowNodeVariableData"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-tsx",meta:'pure title="variable-plugin.tsx"',children:"import {\n  FlowNodeVariableData,\n  ASTFactory,\n} from '@flowgram.ai/fixed-layout-editor';\n\n// ....\n\nflowDocument.onNodeCreate(({ node }) => {\n  const variableData = node.getData<FlowNodeVariableData>(FlowNodeVariableData);\n\n  // ....\n\n  // 1. Clear VariableData if No value\n  variableData.clearVar()\n\n  // 2. Set a String Variable as output\n  variableData.setVar(\n    ASTFactory.createVariableDeclaration({\n      meta: {\n        title: `Your Output Variable Title`,\n      },\n      key: `your_variable_global_unique_key_${node.id}`,\n      type: ASTFactory.createString(),\n    })\n  )\n\n  // 3. Set a Complicated Variable Data as output\n  variableData.setVar(\n    ASTFactory.createVariableDeclaration({\n      meta: {\n        title: `Your Output Variable Title`,\n      },\n      key: `your_variable_global_unique_key_${node.id}`,\n      type: ASTFactory.createArray({\n        items: ASTFactory.createObject({\n          properties: [\n            ASTFactory.createProperty({\n              key: 'stringType',\n              type: ASTFactory.createString(),\n            }),\n            ASTFactory.createProperty({\n              key: 'booleanType',\n              type: ASTFactory.createBoolean(),\n            }),\n            ASTFactory.createProperty({\n              key: 'numberType',\n              type: ASTFactory.createNumber(),\n            }),\n            ASTFactory.createProperty({\n              key: 'integerType',\n              type: ASTFactory.createInteger(),\n            }),\n          ],\n        }),\n      }),\n    })\n  );\n\n  // ....\n})\n\n// ....\n\n"})}),"\n",(0,n.jsxs)(a.p,{children:["More usage, see: ",(0,n.jsx)(a.a,{href:"https://flowgram-ai.github.io/flowgram.ai/auto-docs/editor/classes/FlowNodeVariableData.html",rel:"noopener noreferrer",target:"_blank",children:"Class: FlowNodeVariableData"})]}),"\n",(0,n.jsxs)(a.h3,{id:"set-output-variables-through-form-effect",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#set-output-variables-through-form-effect",children:"#"}),"Set Output Variables through Form Effect"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-tsx",meta:'pure title="node-registries.ts"',children:"import {\n  FlowNodeRegistry,\n  createEffectFromVariableProvider,\n  ASTFactory,\n  type ASTNodeJSON\n} from '@flowgram.ai/fixed-layout-editor';\n\nexport function createTypeFromValue(value: string): ASTNodeJSON | undefined {\n  switch (value) {\n    case 'string':\n      return ASTFactory.createString();\n    case 'number':\n      return ASTFactory.createNumber();\n    case 'boolean':\n      return ASTFactory.createBoolean();\n    case 'integer':\n      return ASTFactory.createInteger();\n\n    default:\n      return;\n  }\n}\n\nexport const nodeRegistries: FlowNodeRegistry[] = [\n  {\n    type: 'start',\n    formMeta: {\n      effect: {\n        'path.to.value': createEffectFromVariableProvider({\n          // parse form value to variable\n          parse(v: string) {\n            return {\n              meta: {\n                title: `Your Output Variable Title`,\n              },\n              key: `your_variable_global_unique_key_${node.id}`,\n              type: createTypeFromValue(v)\n            }\n          }\n        }),\n      },\n      render: () => (\n       // ...\n      )\n    },\n  }\n]\n\n"})}),"\n",(0,n.jsxs)(a.h2,{id:"node-consumes-variables",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#node-consumes-variables",children:"#"}),"Node Consumes Variables"]}),"\n",(0,n.jsxs)(a.h3,{id:"get-variable-list",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#get-variable-list",children:"#"}),"Get Variable List"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-tsx",meta:'pure title="use-variable-tree.tsx"',children:"import {\n  type BaseVariableField,\n  useScopeAvailable,\n} from '@flowgram.ai/fixed-layout-editor';\n\n// .... Inside react hooks or component\n\nconst available = useScopeAvailable()\n\nconst renderVariable = (variable: BaseVariableField) => {\n  // ....\n}\n\nreturn available.variables.map(renderVariable)\n\n// ....\n\n\n"})}),"\n",(0,n.jsxs)(a.h3,{id:"get-drilldown-of-object-type-variable",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#get-drilldown-of-object-type-variable",children:"#"}),"Get Drilldown of Object Type Variable"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-tsx",meta:'pure title="use-variable-tree.tsx"',children:"import {\n  type BaseVariableField,\n  isMatchAST,\n  ObjectType,\n} from '@flowgram.ai/fixed-layout-editor';\n\n// ....\n\nconst renderVariable = (variable: BaseVariableField) => ({\n  title: variable.meta?.title,\n  key: variable.key,\n  // Only Object Type can drilldown\n  children: isMatchAST(type, ObjectType) ? type.properties.map(renderVariable) : [],\n});\n\n// ....\n\n"})}),"\n",(0,n.jsxs)(a.h3,{id:"get-drilldown-of-array-type-variable",children:[(0,n.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#get-drilldown-of-array-type-variable",children:"#"}),"Get Drilldown of Array Type Variable"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-tsx",meta:'pure title="use-variable-tree.tsx"',children:"import {\n  type BaseVariableField,\n  type BaseType,\n  isMatchAST,\n  ObjectType,\n  ArrayType,\n} from '@flowgram.ai/fixed-layout-editor';\n\n// ....\n\nconst getTypeChildren = (type?: BaseType): BaseVariableField[] => {\n  if (!type) return [];\n\n  // get properties of Object\n  if (isMatchAST(type, ObjectType)) return type.properties;\n\n  // get items type of Array\n  if (isMatchAST(type, ArrayType)) return getTypeChildren(type.items);\n};\n\nconst renderVariable = (variable: BaseVariableField) => ({\n  title: variable.meta?.title,\n  key: variable.key,\n  // Only Object Type can drilldown\n  children: getTypeChildren(variable.type).map(renderVariable),\n});\n\n// ....\n\n"})})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:a}=Object.assign({},(0,t.ah)(),e.components);return a?(0,n.jsx)(a,Object.assign({},e,{children:(0,n.jsx)(i,e)})):i(e)}let o=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["en%2Fguide%2Fadvanced%2Fvariable.mdx"]={toc:[{id:"enable-variable-engine",text:"Enable Variable Engine",depth:2},{id:"node-output-variables",text:"Node Output Variables",depth:2},{id:"set-output-variables-through-flownodevariabledata",text:"Set Output Variables through FlowNodeVariableData",depth:3},{id:"set-output-variables-through-form-effect",text:"Set Output Variables through Form Effect",depth:3},{id:"node-consumes-variables",text:"Node Consumes Variables",depth:2},{id:"get-variable-list",text:"Get Variable List",depth:3},{id:"get-drilldown-of-object-type-variable",text:"Get Drilldown of Object Type Variable",depth:3},{id:"get-drilldown-of-array-type-variable",text:"Get Drilldown of Array Type Variable",depth:3}],title:"Use Variables",frontmatter:{}}}}]);